<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Automated Diet Plan Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .glowing-button {
            box-shadow: 0 0 5px #2dd4bf, 0 0 10px #2dd4bf, 0 0 15px #2dd4bf;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #14b8a6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-900 text-green-300 min-h-screen flex items-center justify-center p-4">

    <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-4xl border border-green-700/50">
        <h1 class="text-3xl font-bold text-center mb-2 text-teal-300">Patient Profile Management System</h1>
        <p class="text-center text-green-400 mb-8">Enter patient details to generate a personalized diet plan.</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Left Column -->
            <div>
                <div class="mb-4">
                    <label for="patientName" class="block mb-2 text-sm font-medium">Patient Name</label>
                    <input type="text" id="patientName" class="bg-gray-700 border border-green-600 text-green-300 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5" placeholder="Priya Sharma" value="Priya Sharma">
                </div>
                <div class="mb-4">
                    <label for="age" class="block mb-2 text-sm font-medium">Age</label>
                    <input type="number" id="age" class="bg-gray-700 border border-green-600 text-green-300 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5" placeholder="32" value="32">
                </div>
                <div class="mb-4">
                    <label for="gender" class="block mb-2 text-sm font-medium">Gender</label>
                    <select id="gender" class="bg-gray-700 border border-green-600 text-green-300 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5">
                        <option>Female</option>
                        <option>Male</option>
                        <option>Other</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="prakriti" class="block mb-2 text-sm font-medium">Primary Constitution (Prakriti)</label>
                    <select id="prakriti" class="bg-gray-700 border border-green-600 text-green-300 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5">
                        <option>Vata-Pitta</option>
                        <option>Vata</option>
                        <option>Pitta</option>
                        <option>Kapha</option>
                        <option>Vata-Kapha</option>
                        <option>Pitta-Kapha</option>
                        <option>Tridoshic</option>
                    </select>
                </div>
            </div>

            <!-- Right Column -->
            <div>
                <div class="mb-4">
                    <label for="healthGoals" class="block mb-2 text-sm font-medium">Current Health Goals</label>
                    <select id="healthGoals" class="bg-gray-700 border border-green-600 text-green-300 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5">
                        <option>Improve Digestive Health</option>
                        <option>Weight Loss</option>
                        <option>Weight Gain</option>
                        <option>Increase Energy</option>
                        <option>Manage Stress</option>
                        <option>Improve Sleep</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="activityLevel" class="block mb-2 text-sm font-medium">Activity Level</label>
                    <select id="activityLevel" class="bg-gray-700 border border-green-600 text-green-300 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5">
                        <option>Light Activity</option>
                        <option>Sedentary (little or no exercise)</option>
                        <option>Moderate Activity (3-5 days/week)</option>
                        <option>Very Active (6-7 days/week)</option>
                        <option>Extra Active (very hard exercise/physical job)</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="dietRestrictions" class="block mb-2 text-sm font-medium">Dietary Restrictions</label>
                    <input type="text" id="dietRestrictions" class="bg-gray-700 border border-green-600 text-green-300 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5" placeholder="e.g., Vegetarian, No dairy after 6 PM" value="Vegetarian, No dairy after 6 PM">
                </div>
                <div class="mb-4">
                    <label for="symptoms" class="block mb-2 text-sm font-medium">Current Symptoms</label>
                    <textarea id="symptoms" rows="3" class="bg-gray-700 border border-green-600 text-green-300 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5" placeholder="Describe current health issues...
                    ">Irregular appetite, bloating after meals, afternoon energy dips</textarea>
                </div>
            </div>
        </div>

        <div class="mt-8 flex justify-center items-center space-x-4">
            <button id="updateProfileBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg transition-colors duration-300">
                Update Profile
            </button>
            <button id="generatePlanBtn" class="bg-teal-500 hover:bg-teal-600 text-gray-900 font-bold py-3 px-8 rounded-lg transition-colors duration-300 glowing-button flex items-center">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                Generate Diet Plan
            </button>
        </div>

        <!-- Output Section -->
        <div id="output" class="mt-8 p-6 bg-gray-900/50 rounded-lg border border-green-700/50" style="display: none;">
             <h2 class="text-2xl font-bold text-teal-300 mb-4">Your Personalized Diet Plan</h2>
             <div id="loader" class="loader mx-auto" style="display: none;"></div>
             <div id="planContent" class="text-green-300 prose prose-invert max-w-none"></div>
             <div id="error" class="text-red-400"></div>
        </div>

    </div>

    <script>
        const generatePlanBtn = document.getElementById('generatePlanBtn');
        const outputDiv = document.getElementById('output');
        const planContentDiv = document.getElementById('planContent');
        const loader = document.getElementById('loader');
        const errorDiv = document.getElementById('error');

        generatePlanBtn.addEventListener('click', () => {
            // Show output section and loader
            outputDiv.style.display = 'block';
            loader.style.display = 'block';
            planContentDiv.innerHTML = '';
            errorDiv.innerHTML = '';

            // 1. Gather User Inputs
            const patientName = document.getElementById('patientName').value;
            const age = document.getElementById('age').value;
            const gender = document.getElementById('gender').value;
            const prakriti = document.getElementById('prakriti').value;
            const healthGoals = document.getElementById('healthGoals').value;
            const activityLevel = document.getElementById('activityLevel').value;
            const dietRestrictions = document.getElementById('dietRestrictions').value;
            const symptoms = document.getElementById('symptoms').value;

            // 2. Construct the Prompt for Gemini API
            const prompt = `
                Generate a detailed and personalized 7-day diet plan for the following patient based on Ayurvedic principles.
                The plan should be easy to follow, practical, and tailored to their specific needs.
                Please structure the output in Markdown format with headings for each day.
                For each day, provide meal suggestions for Breakfast, Lunch, and Dinner.
                Include a "Mid-day Snack" and "Evening Snack" as well.
                Also, add a section at the end with "General Recommendations" based on their profile.

                Patient Profile:
                - Name: ${patientName}
                - Age: ${age}
                - Gender: ${gender}
                - Primary Constitution (Prakriti): ${prakriti}
                - Current Health Goals: ${healthGoals}
                - Activity Level: ${activityLevel}
                - Dietary Restrictions: ${dietRestrictions}
                - Current Symptoms: ${symptoms}
            `;

            // 3. Call the Gemini API
            generateDietPlan(prompt);
        });

        async function generateDietPlan(prompt) {
             // IMPORTANT: In a real application, you should not expose your API key like this.
             // This is for demonstration purposes only.
             // Consider using a backend server to securely manage your API key.
            const apiKey = "AIzaSyDOO0w1FU9tFDSIcLONxuxsIBAk1lVyQY4"; // <-- Add your Gemini API Key here
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            if (!apiKey) {
                loader.style.display = 'none';
                errorDiv.innerText = "API Key is missing. Please add your Gemini API key in the script.";
                return;
            }

            const payload = {
                contents: [{
                    parts: [{
                        text: prompt
                    }]
                }],
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload),
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                
                // 4. Display the result
                loader.style.display = 'none';
                
                if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) {
                     // Using a simple regex to format the markdown-like output from the model
                    let formattedText = result.candidates[0].content.parts[0].text;
                    formattedText = formattedText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>'); // Bold
                    formattedText = formattedText.replace(/\*(.*?)\*/g, '<em>$1</em>');       // Italic
                    formattedText = formattedText.replace(/### (.*)/g, '<h3 class="text-lg font-semibold text-teal-300 mt-4 mb-2">$1</h3>');
                    formattedText = formattedText.replace(/## (.*)/g, '<h2 class="text-xl font-bold text-teal-200 mt-6 mb-3">$1</h2>');
                    formattedText = formattedText.replace(/- (.*)/g, '<li class="ml-4">$1</li>');
                    
                    planContentDiv.innerHTML = formattedText.split('\n').map(p => `<p>${p}</p>`).join('');

                } else {
                   throw new Error("Invalid response structure from API.");
                }

            } catch (error) {
                loader.style.display = 'none';
                console.error('Error:', error);
                errorDiv.innerText = `An error occurred while generating the diet plan: ${error.message}. Please check the console for more details.`;
            }
        }
    </script>
</body>
</html>